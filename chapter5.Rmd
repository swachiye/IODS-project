---
title: "chapter5.Rmd"
author: "Sheila"
date: "25/11/2020"
output: html_document
---

```{r}
human <- read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human2.txt", sep=",", header=TRUE)

# Accesss necessary library
library(dplyr)
library(ggplot2)
library(GGally)

```

Data structure

```{r}
# Structure 
str(human)

# Dimension
dim(human)

```

Summarise Data

```{r}
summary(human)
```


```{r}
# glimpse at the human data
glimpse(human)

```
  
Explore relationships

```{r}
# Access GGally
library(GGally)

# To visualise the correlation between the variables in our data
ggpairs(human)

```
The diagonal plots give the density plot. The scale of the y axis is printed on the left side of the matrix and x axis is at the bottom of the matrix. 

The upper part of the density plot gives the pearsonâ€™s correlation coefficient of determination (R2) showing positive and negative (-) correlations between the variable in the human development Index. 

Variable that are significantly positive or significantly negative are give by the symbol (***)

The plot below the density plot shows the scatter plot between two variables


We can also look at the correlations using the cor from the *corrplot function*

```{r}
# Access corrplot
library(corrplot)

# compute the correlation matrix and visualize it with corrplot
cor(human) %>% corrplot

```


Principal Component Analysis (PCA) 

Unstandardise data
```{r}
# perform principal component analysis (with the SVD method)
pca_human1 <- prcomp(human, scale = TRUE)
summary(pca_human1)

# draw a biplot of the principal component representation and the original variables
biplot(pca_human1, choices = 1:2, cex = c(0.8, 1),col = c("grey30", "red"))
```
The first principal components account for 53.6% of the total variance and the second 16.2%


We can plot the eigenvalues to visualize the proportion of variance explained by each each principal component.

```{r}

# Access the factoextra 
library(factoextra)

#Visualize eigenvalues 

fviz_eig(pca_human1)


# Anothe way to draw a biplot of the principal component
# Gives percentage variance of PC1 on the x axis and PC2 on the y axis
fviz_pca_biplot(pca_human1, repel = TRUE, col.var = "#2E8FDF", # Variables color
                col.ind = "#696959"  # Individuals color
                )
```


Standardised data

```{r}
# standardize the variables
human_std <- scale(human)

# perform principal component analysis (with the SVD method)
pca_human2 <- prcomp(human_std)
summary(pca_human2)

# draw a biplot of the principal component representation and the original variables
biplot(pca_human2, choices = 1:2, cex = c(0.8, 1),col = c("grey30", "red"))


```
```{r}

# Access the factoextra 
library(factoextra)

#Visualize eigenvalues 

fviz_eig(pca_human2)


# Anothe way to draw a biplot of the principal component
# Gives percentage variance of PC1 on the x axis and PC2 on the y axis
fviz_pca_biplot(pca_human2, repel = TRUE, col.var = "#2E5FDF", # Variables color
                col.ind = "#696959"  # Individuals color
                )
```
                    